#!/usr/bin/env python

import io
import optparse
import os
import sys

pwd = os.path.dirname(__file__)
root = os.path.join(pwd, '..')
sys.path.append(root)

from skadi import demo


option_parser = optparse.OptionParser()
(options, args) = option_parser.parse_args()

path = os.path.join(root, args[0])

print '> opening {0}'.format(os.path.basename(path))

with io.open(path, 'r+b') as infile:
  replay = demo.construct(infile)

  streamer = replay.stream(tick=0)
  for tick, string_tables, entities in streamer:
    print 'at tick {0}: {1} entities'.format(tick, len(entities))
